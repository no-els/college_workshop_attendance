<template>
  <div class="workshop-banner" if:true={showCollegeSuccess}>
    <h1>{currentWorkshop.name}</h1>
    <p><strong>Date:</strong> {currentWorkshop.date}</p>
    <lightning-button label="Go" onclick={handleEditWorkshop} variant="brand" size="small"></lightning-button>
    <c-new-workshop-modal onworkshopcreated={refreshWorkshops}></c-new-workshop-modal>

    <c-near-peer-toggle 
    workshop-id={currentWorkshop.id}
    is-near-peer={currentWorkshop.isNearPeer}
    config={config}
    ontogglenearpeer={handleToggle}>
    </c-near-peer-toggle>

    <c-workshop-completed-toggle
    workshop-id={currentWorkshop.id}
    config={config}
    ontogglecompleted={handleToggleCompleted}
    completed={currentWorkshop.completed}>
  </c-workshop-completed-toggle>

    <c-show-date-toggle
    workshop-id={currentWorkshop.id}
    config={config}
    ontoggledate={handleToggleDate}>
    </c-show-date-toggle>

  </div>

  <div class="three-col-container">
    <!-- SIDEBAR -->
    <div class={sidebarClass}>
      <lightning-button-icon 
        icon-name={sidebarIcon} 
        variant="bare"
        alternative-text="Toggle sidebar"
        onclick={toggleSidebar}>
      </lightning-button-icon>

      <!-- NEW: make only the body scroll, not the whole column -->
      <div class="sidebar-body slds-scrollable_y">
        <template if:true={isSidebarOpen}>
          <c-workshop-selector 
            onworkshopchange={handleWorkshopSelect}
            onsitefilterchange={handleSiteFilterChange}
            config={config}>
          </c-workshop-selector>
        </template>
      </div>
    </div>

    <!-- MIDDLE COLUMN -->
    <div class="col">
      <!-- NEW: scroll area for the middle column -->
      <div class="col-scroll slds-scrollable_y">
        <c-batch-attendance-from-cohort
          workshop-id={currentWorkshop.id}
          config={config}
          onrefreshattendees={handleRefreshAttendees}>
        </c-batch-attendance-from-cohort>

        <c-possible-attendees-panel 
          selected-workshop-id={currentWorkshop.id}
          config={config}
          onrefreshattendees={handleRefreshAttendees}>
        </c-possible-attendees-panel>
      </div>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="col">
      <!-- If your <c-attendees-panel> already scrolls internally, you can leave it bare.
           If not, wrap it in a col-scroll like the middle column. -->
      <div class="col-scroll slds-scrollable_y">
        <c-attendees-panel workshop-id={currentWorkshop.id} show-near-peer={currentWorkshop.isNearPeer} show-date={currentWorkshop.showDate} config={config}></c-attendees-panel>
      </div>
    </div>
  </div>
</template>